<!DOCTYPE html>
<html lang="en" ng-app="todoApp">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <!------------------- external library-------------------------------->
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
        <!-- for sortable.js -->
        <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>

        <script src="https://code.angularjs.org/1.5.0-rc.0/angular-animate.min.js"></script> 

        <!------------------- App js and css file ---------------------------->
        <script src="javascripts/taskController.js"></script>
        <link rel="stylesheet" href="stylesheets/style.css">
    </head>
    
    <body>

        <!------------------- Navigation bar and menu ------------------------>
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#"><span class="glyphicon glyphicon-list-alt"></span>&nbsp;Todo</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#" data-toggle="modal" data-target="#signin">Sign in</a></li>
                        <li><a href="#" data-toggle="modal" data-target="#signup">Join</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        
        <!-------------------------- main content --------------------------->
        <div class="container" id="mainContainer" ng-controller="taskController">
            
            <!-- Title -->
            <h1 class="center margin-top-md margin-bottom-md"><span class="glyphicon glyphicon-list-alt"></span>&nbsp;To Do List</h1>
            
            
            <!-- The action row, including add, search, filter, and clear trash -->
            <div class="row">
                <form class="form-inline">
                    
                    <!-- search input -->
                    <div class="input-group has-feedback col-sm-offset-1" ng-init="keyword=''">
                        
                        <!-- search icon -->
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-search"></span>
                        </span>
                        
                        <!-- input search keyword -->
                        <input type="text" class="form-control" placeholder="Search" id="keyword" ng-model="keyword" ng-click="onClearSearch($event)" ng-mousemove="onSearchHover($event)">
                        
                        <!-- clear icon -->
                        <span class="form-control-feedback glyphicon glyphicon-remove" ng-show="keyword!=''"></span>
                        
                    </div> <!-- end of search input -->

                    <!-- filter status select -->
                    <div class="input-group hidden-xs col-sm-offset-1">
                        
                        <!-- filter icon -->
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-filter"></span>
                        </span>
                        
                        <!-- status selection -->
                        <select type="select" class="form-control" ng-model="filter">
                            <option value="">All</option>
                            <option value="ongoing">Ongoing</option>
                            <option value="finished">Finished</option>
                            <option value="deleted">Deleted</option>
                        </select>
                        
                    </div>

                </form>
            </div> <!-- end of action row -->
            
            <!-- Table header -->
            <div class="row" id="tableHead">
                <div class="col-xs-2 col-md-1">#</div>
                <div class="col-xs-6 col-md-8">Tasks</div>
                <div class="col-xs-4 col-md-3">Action</div>
            </div> <!-- end of Table header -->
            <hr>
            
            <!-- Table body, repeat rows by using ng-repeat -->
            <div class="row tableRow animate-list {{task.status}}" ng-repeat="task in tasks | filter: {content: keyword, status: filter}" ng-mouseover="activeItem=$index" ng-mouseleave="activeItem=-1">

                <!-- form is for connecting input area and edit done button -->
                <form role="form">                    

                     <!-- task number -->
                    <div class="col-xs-2 col-md-1 grey-color align-right margin-top-xs margin-bottom-xs">
                        <span class="glyphicon" ng-class="statusIcon[task.status]"></span>
                        {{$index + 1}}
                    </div>

                    <!-- task content -->
                    <div class="form-group col-xs-6 col-md-8 margin-top-xs margin-bottom-xs">

                        <!--show static text in normal-->
                        <label ng-hide="editItem==$index">{{task.content}}</label>

                        <!--switch to edit mode-->
                        <!-- editItem class is for controller focus -->
                        <input type="text form-control" class="editItem" placeholder="please type something" ng-model="task.content" style="width: 100%;" ng-show="editItem==$index">

                    </div>

                    <!-- action buttons -->
                    <div class="col-xs-4 col-md-3" ng-show="activeItem==$index && editItem!==$index">

                        <!-- check button -->
                        <button type="button" class="btn btn-default btn-lg btn-check" ng-click="onCheck(task)">
                            <span class="glyphicon glyphicon-check"></span>
                        </button>

                        <!-- edit button -->
                        <button type="button" class="btn btn-default btn-lg btn-edit" ng-disabled="task.status!='ongoing'" ng-click="onEdit($index)">
                            <span class="glyphicon glyphicon-edit"></span>
                        </button>

                        <!-- delete button -->
                        <button type="button" class="btn btn-default btn-lg btn-remove">
                            <span class="glyphicon glyphicon-remove" ng-click="onRemove(task)"></span>
                        </button>

                    </div>

                    <!--edit done button-->
                    <div class="col-xs-4 col-md-3" ng-show="editItem===$index">
                        <button type="submit" class="btn btn-primary" ng-click="onEditDone(task)">Done</button>
                    </div>
                    
                </form>

            </div> <!-- end of table body -->
            
            <!-- A big reminder, only show when there is no any task -->
            <div class="reminder animate-show" ng-show="tasks.length==0">
                <h2>There is no any task!</h2>
            </div>
            
        </div> <!-- end of main content -->
            
        <!----------------------------- footer ---------------------------->          
        <hr>
        <footer>
            <p class="center">&copy; 2016 Benny Xu</p>
        </footer>
        
    </body>
</html>